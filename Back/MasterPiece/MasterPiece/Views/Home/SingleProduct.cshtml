@model Tuple <List<MasterPiece.Models.Comment>, MasterPiece.Models.Product>
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
<link href="~/assets/css/CommentStyle.css" rel="stylesheet">

@{
    ViewBag.Title = "SingleProduct";
    Layout = "~/Views/Shared/MainLayout.cshtml";
}
<style>
    .hide {
        display: none;
    }

    .btn:hover + .hide {
        display: block;
        color: white;
    }
</style>

<div class="breadcrumb-section breadcrumb-bg" style=" background-image: url('../../assets/img/singleproductimage.jpg'); background-repeat: no-repeat; background-attachment: fixed; background-size: cover; ">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 offset-lg-2 text-center">
                <div class="breadcrumb-text">
                    <p>See more Details</p>
                    <h1>@Model.Item2.Product_Name</h1>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- end breadcrumb section -->
<!-- single product -->
<div class="single-product mt-150 mb-150">
    <div class="container">
        <div class="row">
            <div class="col-md-5">
                <div class="single-product-img">
                    <img src="../../ProductImage/@Model.Item2.Product_Image" alt="">
                </div>
            </div>
            <div class="col-md-7">
                <div class="single-product-content">
                    <h3>@Model.Item2.Product_Name</h3>
                    <p class="single-product-pricing"> @Model.Item2.Product_Price JD</p>
                    <p>@Model.Item2.Product_Description</p>
                    <div class="single-product-form">

                        <a href="@Url.Action("AddItem","Home" ,new { Id =Model.Item2.Product_id , returnUrl = Request.RawUrl })" class="cart-btn"><i class="fas fa-shopping-cart"></i> Add to Cart</a>
                        <p><strong>Category: </strong>@Model.Item2.Category.Category_Name</p>
                    </div>
                    
                </div>
            </div>
        </div>
    </div>
</div>
<!-- end single product -->
<!-- Comments -->


<section>
    <div class="container">
        <div class="row">
            <div class="col-sm-5 col-md-6 col-12 pb-4">
                <h1 style="color:darkred">Comments</h1>
                @foreach (var item in Model.Item1)
                {
                    <div class="comment mt-4 text-justify float-left" style="width: 600px; height:150px; overflow: hidden; word-wrap: break-word;">
                        <h4>@item.AspNetUser.first_Name @item.AspNetUser.last_Name</h4>
                        <span class="time">@item.commentDate</span>
                        @if (User.IsInRole("Admin")) { 
                        <a href="@Url.Action("DeleteComment", "Home", new {Id=item.Comment_id, returnUrl = Request.RawUrl })">
                            <i class="far fa-window-close"></i>
                        </a>
                        }
                        <br>
                        <p style="padding-top:30px">@item.Comment_text</p>
                    </div>

                }
            </div>
            <div class="col-lg-4 col-md-5 col-sm-4 offset-md-1 offset-sm-1 col-12 mt-4">


                @using (Html.BeginForm("AddComment", "Home", FormMethod.Post, new { @class = "addComment", @id = "algin-form" }))
                {
                    <input name="Product_id" id="Product_id" value="@Model.Item2.Product_id" style="visibility:hidden;"/>
                    <div class="form-group">
                        <div class="leaveCommentTitle">Leave a comment</div>
                        <br />
                        <label for="message">Message</label>
                        <textarea name="Comment_text" required msg cols="30" rows="5" class="form-control" style="background-color: white;"></textarea>
                    </div>
                    if (User.Identity.IsAuthenticated)
                    {
                        <div class="form-group">
                            <button type="submit" id="post" class="btn">Post Comment</button>
                        </div>

                    }
                    else
                    {
                        <div class="form-group">
                            <button type="submit" id="post" class="btn" disabled>Post Comment</button>
                            <div class="hide">Please Login to Add a comment</div>
                        </div>

                    }
                }
            </div>
        </div>
    </div>
</section>


<br />

<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
@if (TempData["swal_message"] != null)
{
    <script>
    swal({
      title: "@TempData["title"]",
      text: "@TempData["swal_message"]",
      icon: "@TempData["icon"]"
    });
    </script>
}